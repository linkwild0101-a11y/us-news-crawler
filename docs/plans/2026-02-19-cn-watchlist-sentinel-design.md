# 中国大陆视角场景化哨兵（C方案）设计文档

- 日期: 2026-02-19
- 适用系统: US-Monitor
- 设计范围: 政治/安全研判，三哨兵首版（2周可上线）
- 已确认范围:
  - 业务视角: 政策/安全研判
  - 告警策略: 分级处理（L1/L2偏召回，L3/L4偏准确）
  - 首版哨兵: 台海军事动态 / 科技出口管制 / 周边同盟军演
  - 展示形态: 场景态势卡
  - 外部通知: 仅 L3/L4 推送
  - 通知渠道: 飞书机器人

## 1. 目标与成功指标

### 1.1 目标
将现有聚类与信号能力升级为“可执行预警系统”，输出面向研判的结构化告警，而非资讯聚合。

### 1.2 首版成功指标（上线闸门）
- L3/L4 准确率 >= 80%
- 重大事件漏报率 <= 15%
- 首报时延 <= 15 分钟（受采集周期影响时单独标注）
- 单哨兵单日 L3/L4 误报 <= 3 条
- 100% L3/L4 告警可追溯触发依据与证据链接

## 2. 哨兵最小规则集（2周版）

### 2.1 通用分级
- L1 观察: 单源或弱证据命中
- L2 关注: 多源出现且趋势抬升
- L3 预警: 高可信源 + 多维收敛
- L4 紧急: 官方落地或实质动作确认

### 2.2 通用评分
RiskScore = 0.30*场景命中 + 0.20*速度 + 0.20*收敛 + 0.20*源可信 + 0.10*实体飙升

阈值:
- L1 >= 0.35
- L2 >= 0.55
- L3 >= 0.72
- L4 >= 0.88

硬门槛:
- L3: official_sources >= 1 且 unique_domains >= 3
- L4: official_text_effective = true 且 independent_high_trust >= 2

### 2.3 三个哨兵

#### 哨兵A: 台海军事动态
- 触发组: 行动词（越线/战备警巡/实弹/封控/拦截等）+ 地理词（台海/东海/巴士海峡）+ 军事平台词（航母/导弹/舰机）
- 逻辑: 至少命中2组
- 升级: 行动级动词 + 多源确认 + 官方口径
- 抑噪: 历史回顾/纯评论/转载风暴不升L3

#### 哨兵B: 科技出口管制
- 触发组: 政策词（实体清单/许可/最终规则）+ 技术词（AI芯片/EDA/先进制程）+ 执法词（长臂/罚单/次级制裁）
- 逻辑: 必须命中政策词 + 任一组
- 升级: 出现“生效日期/执法条款/扩围范围”至少L3
- 抑噪: 传闻与未落地草案不超L2

#### 哨兵C: 周边同盟军演
- 触发组: 同盟词（美日/美韩/美菲/AUKUS/QUAD）+ 强度词（实弹/反导/跨域/前沿部署）+ 邻近敏感海空域词
- 逻辑: 必须命中同盟词 + 任一组
- 升级: 规模/平台升级 + 敏感区域邻近满足条件时升L3
- 抑噪: 例行低强度活动不升L3

## 3. 数据可行性评估与补强

### 3.1 现状可支撑范围
- 可支撑: L1/L2 全量，L3 部分场景
- 不足: L4 自动化不稳（官方落地证据链不足）

### 3.2 关键缺口
- 来源分层未贯通（source_id 到 domain/tier 未用于规则判分）
- 来源收敛部分仍有模拟逻辑，需替换为真实来源统计
- 外部查询偏泛化（需改为哨兵模板查询）
- 默认 worldmonitor 端点未启军事态势 priority=3 关键端点
- 看板仅“置信度高/中/低”，未展示 L1-L4

### 3.3 最小补源清单（高收益）
- 台海/军情: state.gov, indo-pacificcommand.mil, navy.mil, af.mil, mod.go.jp
- 出口管制: bis.doc.gov, federalregister.gov, home.treasury.gov
- 同盟军演: defence.gov.au, mindef.gov.sg, gov.ph
- 大陆视角校验源: fmprc.gov.cn, mod.gov.cn, xinhuanet.com

## 4. 告警输出与展示/通知设计

### 4.1 告警输出Schema（必填）
- alert_id
- title
- level (L1-L4)
- confidence
- trigger_reasons
- related_entities
- evidence_links
- suggested_action
- next_review_time

### 4.2 展示（已确认）
采用“场景态势卡”布局：
- 每个哨兵1张卡
- 卡内展示: 当前等级、近24h趋势、最新证据、最近一次升级原因
- 颜色: 绿/黄/橙/红 对应 L1/L2/L3/L4

### 4.3 外部通知（已确认）
- 仅 L3/L4 发送外部通知
- 渠道: 飞书机器人
- 建议通知内容:
  - 标题: [哨兵名][等级] + 事件摘要
  - 正文: 触发原因、关键实体、证据链接、建议动作、复核时间
- 建议频控:
  - 同一哨兵同一事件 30 分钟内不重复推送
  - 级别上升时允许立即推送

## 5. 实施映射（最小改造）

### 5.1 配置层
- 新增 `config/watchlist_config.py`（或在 `config/analysis_config.py` 扩展）
- 承载: 哨兵定义、分级阈值、来源分层、外部查询模板

### 5.2 检测层
- 在 `scripts/signal_detector.py` 新增 `detect_watchlist_signals()`
- 输入: 聚类、来源映射、外部端点结果
- 输出: 带 `level/risk_score/trigger_reasons/evidence_links`

### 5.3 增强数据层
- `scripts/datasources/free_data_sources.py` 按哨兵模板生成 GDELT 查询
- 提升 worldmonitor 端点使用范围，纳入军事态势端点

### 5.4 存储层
- `analysis_signals` 增补字段（建议 migration）:
  - sentinel_id
  - alert_level
  - risk_score
  - trigger_reasons (jsonb)
  - evidence_links (jsonb)

### 5.5 展示层
- `web/app.py` 增加“场景态势卡”页面与 L1-L4 过滤
- 维持信号列表作为次级视图

### 5.6 通知层
- 新增 `scripts/notifier.py`（飞书机器人）
- 仅消费 L3/L4 且通过去重/冷却

## 6. 测试与验收

### 6.1 测试层级
- 单测: 规则命中、分级阈值、硬门槛
- 集成: RSS -> 聚类 -> 哨兵评分 -> 落库 -> 看板
- E2E: 端点异常、空数据、重复告警、降级恢复

### 6.2 回测流程（14天）
- D1-D2: 打通真实来源链路
- D3-D5: 三哨兵样本标注（每哨兵40-60）
- D6-D9: 网格调参
- D10-D12: 影子运行（不外发）
- D13-D14: 锁阈值并上线

### 6.3 Go/No-Go
任一核心指标不达标则 No-Go，L3/L4 保持影子模式。

## 7. 运维机制

- 每日双复盘: 误报Top5/漏报Top5/阈值建议
- 每周词典与阈值版本发布（可回滚）
- 值班SOP: L1记录、L2快核、L3 15分钟确认、L4立即升级
- 故障降级: 外部端点异常自动降权，禁止在证据不完整时升L4

## 8. 风险与边界

- 当前采集周期限制“准实时”能力，需与期望时效对齐
- L4 仍需保留人工确认机制
- 规则体系不是一次性工作，需要周更词典和月度审计

## 9. 后续（进入实施规划）

下一步进入 implementation plan，按 P0/P1/P2 拆分任务、定义文件级改造清单与测试工单。
